\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nt}{\PYZlt{}int:channel} \PY{n+na}{id=}\PY{l+s}{\PYZdq{}aggregatorChannel\PYZdq{}} \PY{n+nt}{/\PYZgt{}}
\PY{n+nt}{\PYZlt{}int:aggregator} \PY{n+na}{input\PYZhy{}channel=}\PY{l+s}{\PYZdq{}aggregatorChannel\PYZdq{}} \PY{n+na}{output\PYZhy{}channel=}\PY{l+s}{\PYZdq{}matchedChannel\PYZdq{}} 
                \PY{n+na}{ref=}\PY{l+s}{\PYZdq{}mailAggregator\PYZdq{}} 
                \PY{n+na}{discard\PYZhy{}channel=}\PY{l+s}{\PYZdq{}throwAwayChannel\PYZdq{}} 
                \PY{n+na}{message\PYZhy{}store=}\PY{l+s}{\PYZdq{}aggregatorMessageStore\PYZdq{}} \PY{n+nt}{/\PYZgt{}}

\PY{n+nt}{\PYZlt{}bean} \PY{n+na}{id=}\PY{l+s}{\PYZdq{}aggregatorMessageStore\PYZdq{}} \PY{n+na}{class=}\PY{l+s}{\PYZdq{}org.springframework.integration.store.SimpleMessageStore\PYZdq{}} \PY{n+nt}{/\PYZgt{}}
\PY{n+nt}{\PYZlt{}bean} \PY{n+na}{id=}\PY{l+s}{\PYZdq{}aggregatorReaper\PYZdq{}} \PY{n+na}{class=}\PY{l+s}{\PYZdq{}org.springframework.integration.store.MessageGroupStoreReaper\PYZdq{}}\PY{n+nt}{\PYZgt{}}
    \PY{n+nt}{\PYZlt{}property} \PY{n+na}{name=}\PY{l+s}{\PYZdq{}messageGroupStore\PYZdq{}} \PY{n+na}{ref=}\PY{l+s}{\PYZdq{}aggregatorMessageStore\PYZdq{}} \PY{n+nt}{/\PYZgt{}}
    \PY{n+nt}{\PYZlt{}property} \PY{n+na}{name=}\PY{l+s}{\PYZdq{}timeout\PYZdq{}} \PY{n+na}{value=}\PY{l+s}{\PYZdq{}\PYZdl{}\PYZob{}matcher.reaper.delay\PYZcb{}\PYZdq{}} \PY{n+nt}{/\PYZgt{}}
\PY{n+nt}{\PYZlt{}/bean\PYZgt{}}

\PY{n+nt}{\PYZlt{}task:scheduled\PYZhy{}tasks}\PY{n+nt}{\PYZgt{}}
    \PY{n+nt}{\PYZlt{}task:scheduled} \PY{n+na}{ref=}\PY{l+s}{\PYZdq{}aggregatorReaper\PYZdq{}} \PY{n+na}{method=}\PY{l+s}{\PYZdq{}run\PYZdq{}} \PY{n+na}{fixed\PYZhy{}rate=}\PY{l+s}{\PYZdq{}10000\PYZdq{}}\PY{n+nt}{/\PYZgt{}}
\PY{n+nt}{\PYZlt{}/task:scheduled\PYZhy{}tasks\PYZgt{}}
\end{Verbatim}
